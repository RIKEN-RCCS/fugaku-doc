
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/fugaku/docs/img/favicon.ico">

    <title>1. Overview &#8212; Supercomputer Fugaku Users Guide - TAU -  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css?v=5283bb3d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=f85107c5" />
    
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="TAU User Guide" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="index.html" title="TAU User Guide"
             accesskey="P">previous</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Supercomputer Fugaku Users Guide - TAU -  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>Overview</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="overview">
<h1><span class="section-number">1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h1>
<p>TAU (Tuning and Analysis Utilities) is a performance analysis tool
for parallel programs written in C/C++, Fortran, Java, Python, and UPC <a class="footnote-reference brackets" href="#tau" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
Here we show how to run the program using TAU on Supercomputer Fugaku.</p>
<p>For more information on TAU, please refer to <a class="reference external" href="http://www.cs.uoregon.edu/research/tau/">http://www.cs.uoregon.edu/research/tau/</a>.</p>
</section>
<section id="notification">
<h1><span class="section-number">2. </span>Notification<a class="headerlink" href="#notification" title="Link to this heading">¶</a></h1>
<p>As of March 2024, TAU has version 2.32.1 installed. The installation location is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/vol0004/apps/oss/tau
</pre></div>
</div>
<p>To use TAU, invoke the installed TAU environment and run tau_exec by mpiexec.
By passing runtime options at that time, you can have TAU analyze the performance of the executable program.
For example, the following options allow output of profile results:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22.2%" />
<col style="width: 77.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Options</p></th>
<th class="head"><p>Outputs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-ebs</p></td>
<td><p>Enable event-based sampling</p></td>
</tr>
<tr class="row-odd"><td><p>-io</p></td>
<td><p>Track I/O</p></td>
</tr>
<tr class="row-even"><td><p>-memory</p></td>
<td><p>Track memory (*)</p></td>
</tr>
</tbody>
</table>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In version 2.32.1, we have confirmed that the executable program hangs when the -memory option is used in Supercomputer Fugaku.
If you wish to perform memory tracking, do not use this runtime option,
but enable the environment variable TAU_TRACK_MEMORY_FOOTPRINT, which has the same effect.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TAU_TRACK_MEMORY_FOOTPRINT</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<p>To easily view profile results, use pprof.
Since the results are displayed on standard output on a text basis,
it is convenient to redirect to a log file to describe the results.</p>
</section>
<section id="how-to-execute">
<h1><span class="section-number">3. </span>How to execute<a class="headerlink" href="#how-to-execute" title="Link to this heading">¶</a></h1>
<p>Here we show how to execute in Supercomputer Fugaku with a test program using TAU.</p>
<p>The job is described as follows:</p>
<p>[Example]</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /bin/bash -x</span>
<span class="c1">#PJM -L node=1</span>
<span class="c1">#PJM -L elapse=00:10:00</span>
<span class="c1">#PJM -x PJM_LLIO_GFSCACHE=/vol0004</span>
<span class="c1">#PJM --mpi max-proc-per-node=48</span>
<span class="c1">#PJM -g groupname</span>
<span class="c1">#PJM -s</span>
<span class="c1">#</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PARALLEL</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># TAU</span>
.<span class="w"> </span>/vol0004/apps/oss/tau/setup-env.sh

<span class="c1"># run</span>
mpiexec<span class="w"> </span>tau_exec<span class="w"> </span>-ebs<span class="w"> </span>./test.exe
pprof<span class="w"> </span>-a<span class="w"> </span>&gt;<span class="w"> </span>tau_profile.log
</pre></div>
</div>
<p>An example of the results of the execution is the text output by pprof command.
This is part of the I/O tracking results.</p>
<p>[Results]</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>USER<span class="w"> </span>EVENTS<span class="w"> </span>Profile<span class="w"> </span>:NODE<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>CONTEXT<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>THREAD<span class="w"> </span><span class="m">0</span>
---------------------------------------------------------------------------------------
NumSamples<span class="w">   </span>MaxValue<span class="w">   </span>MinValue<span class="w">  </span>MeanValue<span class="w">  </span>Std.<span class="w"> </span>Dev.<span class="w">  </span>Event<span class="w"> </span>Name
---------------------------------------------------------------------------------------
<span class="w">       </span><span class="m">948</span><span class="w">  </span><span class="m">1</span>.024E+07<span class="w">          </span><span class="m">2</span><span class="w">  </span><span class="m">1</span>.892E+04<span class="w">  </span><span class="m">3</span>.474E+05<span class="w">  </span>Bytes<span class="w"> </span>Read
<span class="w">       </span><span class="m">393</span><span class="w">  </span><span class="m">1</span>.366E+06<span class="w">          </span><span class="m">8</span><span class="w">  </span><span class="m">1</span>.286E+04<span class="w">  </span><span class="m">9</span>.108E+04<span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>MPI_Finalize<span class="o">()</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>read<span class="o">()</span>
<span class="w">         </span><span class="m">4</span><span class="w">         </span><span class="m">21</span><span class="w">          </span><span class="m">6</span><span class="w">      </span><span class="m">17</span>.25<span class="w">      </span><span class="m">6</span>.495<span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>MPI_Init<span class="o">()</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>fscanf<span class="o">()</span>
<span class="w">       </span><span class="m">307</span><span class="w">       </span><span class="m">8192</span><span class="w">          </span><span class="m">2</span><span class="w">      </span><span class="m">114</span>.5<span class="w">      </span><span class="m">707</span>.9<span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>MPI_Init<span class="o">()</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>read<span class="o">()</span>
<span class="w">         </span><span class="m">3</span><span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">4</span><span class="w">          </span><span class="m">0</span><span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>MPI_Init<span class="o">()</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>recv<span class="o">()</span>
<span class="w">       </span><span class="m">235</span><span class="w">  </span><span class="m">1</span>.024E+07<span class="w">          </span><span class="m">2</span><span class="w">  </span><span class="m">5</span>.465E+04<span class="w">  </span><span class="m">6</span>.864E+05<span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>read<span class="o">()</span>
<span class="w">         </span><span class="m">6</span><span class="w">        </span><span class="m">107</span><span class="w">          </span><span class="m">4</span><span class="w">      </span><span class="m">50</span>.67<span class="w">      </span><span class="m">41</span>.43<span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>recvfrom<span class="o">()</span>
<span class="w">         </span><span class="m">1</span><span class="w">       </span><span class="m">2902</span><span class="w">       </span><span class="m">2902</span><span class="w">       </span><span class="m">2902</span><span class="w">          </span><span class="m">0</span><span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>&lt;<span class="nv">file</span><span class="o">=</span>//etc/opt/FJSVtcs/ple/pmix-mca-params.conf&gt;
<span class="w">         </span><span class="m">1</span><span class="w">       </span><span class="m">2902</span><span class="w">       </span><span class="m">2902</span><span class="w">       </span><span class="m">2902</span><span class="w">          </span><span class="m">0</span><span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>&lt;<span class="nv">file</span><span class="o">=</span>//etc/opt/FJSVtcs/ple/pmix-mca-params.conf&gt;<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>MPI_Init<span class="o">()</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>read<span class="o">()</span>
<span class="w">         </span><span class="m">1</span><span class="w">        </span><span class="m">353</span><span class="w">        </span><span class="m">353</span><span class="w">        </span><span class="m">353</span><span class="w">          </span><span class="m">0</span><span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>&lt;<span class="nv">file</span><span class="o">=</span>/etc/opt/FJSVtcs/krm/libpxkrm.conf&gt;
<span class="w">         </span><span class="m">1</span><span class="w">        </span><span class="m">353</span><span class="w">        </span><span class="m">353</span><span class="w">        </span><span class="m">353</span><span class="w">          </span><span class="m">0</span><span class="w">  </span>Bytes<span class="w"> </span>Read<span class="w"> </span>&lt;<span class="nv">file</span><span class="o">=</span>/etc/opt/FJSVtcs/krm/libpxkrm.conf&gt;<span class="w"> </span>:<span class="w"> </span><span class="nv">taupreload_main</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>read<span class="o">()</span>
</pre></div>
</div>
<p class="rubric">Footnote</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="tau" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="19">
<li><p>Shende and A. D. Malony, “The TAU Parallel Performance System,” International Journal of High Performance Computing Applications, SAGE Publications, 20(2):287-331, Summer 2006.</p></li>
</ol>
</aside>
</aside>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">1. Overview</a></li>
<li><a class="reference internal" href="#notification">2. Notification</a></li>
<li><a class="reference internal" href="#how-to-execute">3. How to execute</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">TAU User Guide</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="index.html" title="TAU User Guide"
             >previous</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Supercomputer Fugaku Users Guide - TAU -  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>Overview</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, RIKEN Center for Computational Science.
    &nbsp;&nbsp;<a href="https://www.fugaku.r-ccs.riken.jp/en/">Fugaku Portal Top</a>
    </div>
  </body>
</html>