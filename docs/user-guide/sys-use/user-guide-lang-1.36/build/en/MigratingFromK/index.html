

<!doctype html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8. Migration from K &#8212; Supercomputer Fugaku User Guide －Language and development environment－  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=532c1bf3" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f85107c5" />
    
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="7. Script language" href="../ScriptingLanguage/index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../ScriptingLanguage/index.html" title="7. Script language"
             accesskey="P">previous</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Supercomputer Fugaku User Guide －Language and development environment－  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8. </span>Migration from K</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="migration-from-k">
<h1><span class="section-number">8. </span>Migration from K<a class="headerlink" href="#migration-from-k" title="Link to this heading">¶</a></h1>
<p>Here explains about migration from K.</p>
<section id="overview">
<h2><span class="section-number">8.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Here describes about the main difference between the language environment offered in Supercomputer K and Supercomputer Fugaku‘s language environment.</p>
</section>
<section id="language-environment-correspondance">
<h2><span class="section-number">8.2. </span>Language environment correspondance<a class="headerlink" href="#language-environment-correspondance" title="Link to this heading">¶</a></h2>
<p>On Supercomputer Fugaku, as the same as Supercomputer K, it supports for Fortran, C, C++, MPI and OpenMP.</p>
<p>Supported language style is changed as following. Please be aware that if you are describing in the in incompatible.</p>
<p>[Supported language style]</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 37.5%" />
<col style="width: 37.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Section</p></th>
<th class="head"><p>K</p></th>
<th class="head"><p>Fugaku</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Fortran</p></td>
<td><p>ISO/IEC 1539-1:2004 (Fortran 2003)</p></td>
<td><p>ISO/IEC 1539-1:2010 (Fortran 2008)</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>ISO/IEC 9899:1999 (C99 standard)</p></td>
<td><p>ISO/IEC 9899:2011 (C11 standard)</p></td>
</tr>
<tr class="row-even"><td><p>C++</p></td>
<td><p>ISO/IEC 14882:2014 (C++14 standard)</p></td>
<td><p>ISO/IEC 14882:2017 (C++14 standard)</p></td>
</tr>
<tr class="row-odd"><td><p>MPI</p></td>
<td><p>2.2</p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-even"><td><p>OpenMP</p></td>
<td><p>3.1</p></td>
<td><p>4.0</p></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>About the detail of  Supercomputer Fugaku, please refer to  <a class="reference internal" href="../CompileforCN/FujitsuCompiler/LanguageSpecifications.html#languagespecifications"><span class="std std-ref">Language specification</span></a> .</p>
</div>
</div></blockquote>
</section>
<section id="version-check-method">
<h2><span class="section-number">8.3. </span>Version check method<a class="headerlink" href="#version-check-method" title="Link to this heading">¶</a></h2>
<p>Here indicates the direction of version check.</p>
<p>When compiling, language software version supecifies <code class="docutils literal notranslate"><span class="pre">-V</span></code> option.</p>
<p>In the following example, it is figured out that the version is 4.8.1.</p>
<ul class="simple">
<li><p>An example of Fortran</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[_LNlogin]$ </span>mpifrtpx<span class="w"> </span>-V<span class="w"> </span>program.f
<span class="go">frtpx: Fujitsu Fortran Compiler 4.8.1 tcsds-1.2.36</span>
<span class="go">jwd_fortpx: Fujitsu Fortran Compiler 4.8.1 (Jun 30 2022 15:02:42)</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>An example of C/C++</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[_LNlogin]$ </span>mpifccpx<span class="w"> </span>-V<span class="w"> </span>main.c
<span class="go">fccpx: Fujitsu C/C++ Compiler 4.8.1 tcsds-1.2.36</span>
<span class="go">simulating gcc version 6.1</span>
<span class="go">ccpcompx: Fujitsu C/C++ Compiler 4.8.1 (Jun 16 2022 14:47:00)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="incompatible-item">
<h2><span class="section-number">8.4. </span>Incompatible item<a class="headerlink" href="#incompatible-item" title="Link to this heading">¶</a></h2>
<p>Here indicates the main incompatible about compile option and operation.</p>
<section id="fortran">
<h3><span class="section-number">8.4.1. </span>Fortran<a class="headerlink" href="#fortran" title="Link to this heading">¶</a></h3>
<p>Please see “Fortran User’s Guide” about the detail of each function indicated here.</p>
<ol class="arabic">
<li><dl class="simple">
<dt>Convert to default -Kauto, -Ktemparraystack, -Kautoobjstack option</dt><dd><p>There is a case that stuck use size might increase than original.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Return value of IOSTAT specifier at execution of non-stop output statement</dt><dd><p>The value returned to the IOSTAT specifier when the length of a Fortran record determined by a format specification exceeds the logical record length in a non-persistent output statement has been changed.
“134” is returned to the IOSTAT specifier. Previously, “-2” was returned.</p>
<p>For a program that processes according to the value of the IOSTAT specifier, the program needs to be changed.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Specification change of runtime information output function</dt><dd><div class="line-block">
<div class="line">Information (part of cost information, parallelization information, input / output information, hardware monitor information) that could be acquired as a runtime information output function cannot be acquired.</div>
<div class="line">Also it makes unable to obtain information by area specification (start_collection/stop_collection. If the range specification (start_collection / stop_collection) and its definition (fjcoll_lib) exist in the source program, an error will occur during compilation.</div>
</div>
<p>If you want to obtain parallelization information, and hardware monitor information, use a CPU performance analysis tool.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Implement of LLVM OpenMP library</dt><dd><div class="line-block">
<div class="line">Parallelization function uses LLVM OpenMP library as a default.</div>
<div class="line">If use the original  Fujitsu OpenMP library, specify  <code class="docutils literal notranslate"><span class="pre">-Nfjomplib</span></code> option.</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Value change on macto and named constant by support of OpenMP API version 4.0 style.</dt><dd><div class="line-block">
<div class="line">When specified translation option  <code class="docutils literal notranslate"><span class="pre">-Kopenmp</span></code> ,  <code class="docutils literal notranslate"><span class="pre">-D_OPENMP=201307</span></code>  is enabled.</div>
<div class="line">Named constant openmp_version’s value will be 201307.</div>
</div>
<p>If your program uses the value of the macro _OPENMP or the named constant openmp_version, modify your program to correspond to the changed value.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Removal of translation option -K {openmp_tls | openmp_notls}</dt><dd><p>If specified  <code class="docutils literal notranslate"><span class="pre">-K{openmp_tls|openmp_notls}</span></code> option, the following alart message is output when translation.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : -Kopenmp_[no]tls  option is abolished.</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>-Kvppocl option abolish</dt><dd><p>If  <code class="docutils literal notranslate"><span class="pre">-Kvppocl</span></code> option and  <code class="docutils literal notranslate"><span class="pre">-Kocl</span></code> option is enabled, the optimization directive NOVREC was treated the same as the optimization directive NORECURRENCE. Since  <code class="docutils literal notranslate"><span class="pre">-Kvppocl</span></code> option is abolished, it became to unable to use those equally.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Change the options available on the compiler directive line “!optoins”</dt><dd><div class="line-block">
<div class="line">The -O[1-3] options can be specified as compiler options.</div>
<div class="line">If you want to enable transtlation option that specified with compiler directive line “!options” , proceed the following steps.</div>
</div>
<ul class="simple">
<li><p>!Cut out the procedure that describes the options line to another file and translate it with the options specified in the! options line</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>-Nuse_rodata option abolish and style change</dt><dd><div class="line-block">
<div class="line">Executing a program that assigns to a constant other than a constant argument may cause abnormal termination at runtime.</div>
<div class="line">Change the program to not proceed assign to constant</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Style change of -Kswp and -Kswp_strong option</dt><dd><p>Once specified <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code> option behind  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code>  option,  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code> option is unabled and  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code> option is enabled.</p>
<p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code>  option, specify behind of <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code>or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code>option.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>-Kdalign option abolish</dt><dd><p>Compile option  <code class="docutils literal notranslate"><span class="pre">-Kdalign</span></code> is unabled and alartted as following.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : Sub option dalign, specified to -K is incorrect.</span>
</pre></div>
</div>
<p>If specified  <code class="docutils literal notranslate"><span class="pre">-Kdalign</span></code> to match common variable member align, specify  <code class="docutils literal notranslate"><span class="pre">-Kalign_commons</span></code>.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Change -Kprefetch_strong to default</dt><dd><div class="line-block">
<div class="line">The L1 prefetch instruction operates as a strong prefetch by default created by  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_sequential</span></code>, <code class="docutils literal notranslate"><span class="pre">-Kprefetch_stride</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_indirect</span></code>.</div>
<div class="line">When generating a prefetch instruction that operates as a weak prefetch, specify  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code>.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>To enable -Kprefetch_nostrong and  -Kprefetch_nostrong_L2 ,  -Khpctag is required.</dt><dd><p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code> and  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong_L2</span></code>,  <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is required. <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is enabled as default.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Behavior change when an unrecognized option is specified</dt><dd><div class="line-block">
<div class="line">If an unrecognized option is specified, a warning message will be output and the specification will be ignored.</div>
<div class="line">Previously, a warning message was output and passed to the linker.</div>
<div class="line">To give an option to linker, use  <code class="docutils literal notranslate"><span class="pre">-Wl</span></code> option.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Changes how the -NRtrap option is specified</dt><dd><p>To enable the -NRtrap option, it must be set at both compilation and linking.</p>
</dd>
</dl>
</li>
</ol>
</section>
<section id="c-language">
<h3><span class="section-number">8.4.2. </span>C language<a class="headerlink" href="#c-language" title="Link to this heading">¶</a></h3>
<p>Please see “C User’s Guide” about the detail of each function indicated here.</p>
<ol class="arabic">
<li><dl>
<dt>Convert to default -Klib opiton</dt><dd><p>If  <code class="docutils literal notranslate"><span class="pre">-O0</span></code> option is enabled, when omitted,  <code class="docutils literal notranslate"><span class="pre">-Knolib</span></code> option is applied. Also more than  <code class="docutils literal notranslate"><span class="pre">-O1</span></code> is enabled, when omitted,  <code class="docutils literal notranslate"><span class="pre">-Klib</span></code> option is appiled.</p>
<p>If this option is enabled and the user defines a function with the same name as the standard library function, the result intended by the user may not be obtained.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Specification change of runtime information output function</dt><dd><p>Information (part of cost information, parallelization information, input / output information, hardware monitor information) that could be acquired as a runtime information output function cannot be acquired. It makes unable to obtain information by area specification (start_collection/stop_collection.</p>
<p>If the range specification (start_collection / stop_collection) and its definition (fjcoll_lib) exist in the source program, an error will occur during compilation.
If you want to obtain parallelization information, and hardware monitor information, use a CPU performance analysis tool.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Implement of LLVM OpenMP library</dt><dd><div class="line-block">
<div class="line">Parallelization function uses LLVM OpenMP library as a default.</div>
<div class="line">If use the original  Fujitsu OpenMP library, specify  <code class="docutils literal notranslate"><span class="pre">-Nfjomplib</span></code> option.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Abolish of translation option -noansi</dt><dd><p>If specify language style level,  use  <code class="docutils literal notranslate"><span class="pre">-std</span></code> option.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Translation option -f{signed-char|unsigned-char} omit value change</dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">-f{signed-char|unsigned-char}</span></code>option is omitted,  <code class="docutils literal notranslate"><span class="pre">-funsigned-char</span></code> option is applied abd predefined macro __SIGNED_CHARS__ is not defined.</p>
<p>If there is only a declaration of char type in the source program, the sign may change, and the operation of the program may be different from before.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Translation option -X abolished (language specification mode is GNU compatible mode only)</dt><dd><p>GNU C extention style is abusolutely enabled.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>GNU C compatible version change</dt><dd><p>Each macro value is as below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__GNUC__</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>__GNUC_MINOR__</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>__GNUC_PATCHLEVEL__</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<p>If each macro value is used in the program, modify the program to correspond to the above values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Omit value change of translation option -std</dt><dd><p>If omitted <code class="docutils literal notranslate"><span class="pre">-std</span></code> option,  <code class="docutils literal notranslate"><span class="pre">-std=gnu11</span></code> is applied. To specify language style level, use  <code class="docutils literal notranslate"><span class="pre">-std</span></code> option.</p>
</dd>
</dl>
</li>
<li><p>Definition change of macro __STRICT_ANSI__, linux, unix and __STDC_VERSION__</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 28.6%" />
<col style="width: 71.4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Change contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__STRICT_ANSI__</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-ansi</span></code> option or  <code class="docutils literal notranslate"><span class="pre">-std={c89|c99}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>linux</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-std={gnu89|gnu99}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>unix</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-std={gnu89|gnu99}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>__STDC_VERSION__</p></td>
<td><p>Not defined if  <code class="docutils literal notranslate"><span class="pre">-std={c89|gnu89}</span></code>option is enabled.</p></td>
</tr>
</tbody>
</table>
<p>If each macro is used in the program, modify the program to correspond to the above definition.</p>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>Operation change if specified translation option -Dname and -Uname</dt><dd><p>If specified the same name to  <code class="docutils literal notranslate"><span class="pre">-D</span></code> option and  <code class="docutils literal notranslate"><span class="pre">-U</span></code> option, the latst specification is enabled.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Omit value change of traslation option -N{line|noline}</dt><dd><p>When omitted  <code class="docutils literal notranslate"><span class="pre">-N{line|noline}</span></code> option,  <code class="docutils literal notranslate"><span class="pre">-Nline</span></code> option is applied.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Removal of translation option -K {openmp_tls | openmp_notls}</dt><dd><p>If specified  <code class="docutils literal notranslate"><span class="pre">-K{openmp_tls|openmp_notls}</span></code> option, the following alart message is output when translation.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : -Kopenmp_[no]tls  option is abolished.</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Style change of -Kswp and -Kswp_strong option</dt><dd><p>Specify  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code> behind of  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code>option,  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code> option is unabled and  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code> option is enabled.</p>
<p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code> option, specify behind of  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code> option.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>-Kdalign option abolish</dt><dd><p>Compile option  <code class="docutils literal notranslate"><span class="pre">-Kdalign</span></code> is unabled and alartted as following.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : Sub option dalign, specified to -K is incorrect.</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Specification changes for built-in functions __sync_fetch_and_nand and __sync_nand_and_fetch</dt><dd><p>Changed to as following.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Built-in functions</p></th>
<th class="head"><p>Operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type __sync_fetch_and_nand (type *ptr, type value, …)</p></td>
<td><div class="line-block">
<div class="line">tmp = *ptr;</div>
<div class="line">*ptr = ~(tmp &amp; value);</div>
<div class="line">return tmp;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>type __sync_nand_and_fetch (type *ptr, type value, …)</p></td>
<td><div class="line-block">
<div class="line">*ptr = ~(*ptr &amp; value);</div>
<div class="line">return *ptr;</div>
</div>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
<li><dl>
<dt>Change -Kprefetch_strong to default</dt><dd><p>The L1 prefetch instruction operates as a strong prefetch by default created by  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_sequential</span></code>, <code class="docutils literal notranslate"><span class="pre">-Kprefetch_stride</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_indirect</span></code>.</p>
<p>When generating a prefetch instruction that operates as a weak prefetch, specify  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>To enable -Kprefetch_nostrong and -Kprefetch_nostrong_L2 , -Khpctag is required.</dt><dd><p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code> and  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong_L2</span></code>,  <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is required. <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is enabled as a default.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Behavior change when an unrecognized option is specified</dt><dd><div class="line-block">
<div class="line">If an unrecognized option is specified, a warning message will be output and ignored.</div>
<div class="line">Previously, a warning message was output and passed to the linker.</div>
<div class="line">When passing options to the linker, use the <code class="docutils literal notranslate"><span class="pre">-Wl</span></code> option.</div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="c">
<h3><span class="section-number">8.4.3. </span>C++<a class="headerlink" href="#c" title="Link to this heading">¶</a></h3>
<p>Please see “C++ User’s Guide” about the detail of each function indicated here.</p>
<ol class="arabic">
<li><dl>
<dt>Convert to default -Klib opiton</dt><dd><p>If  <code class="docutils literal notranslate"><span class="pre">-O0</span></code> option is enabled, when omitted,  <code class="docutils literal notranslate"><span class="pre">-Knolib</span></code> option is applied.  Also more than  <code class="docutils literal notranslate"><span class="pre">-O1</span></code>is enabled, when omitted,  <code class="docutils literal notranslate"><span class="pre">-Klib</span></code> option is applied.</p>
<blockquote>
<div><p>If this option is enabled and the user defines a function with the same name as the standard library function, the result intended by the user may not be obtained.</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl>
<dt>Specification change of runtime information output function</dt><dd><p>Information (part of cost information, parallelization information, input / output information, hardware monitor information) that could be acquired as a runtime information output function cannot be acquired. It makes unable to obtain information by area specification (start_collection/stop_collection.</p>
<p>If the range specification (start_collection / stop_collection) and its definition (fjcoll_lib) exist in the source program, an error will occur during compilation.
If you want to obtain parallelization information, and hardware monitor information, use a CPU performance analysis tool.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Implement of LLVM OpenMP library</dt><dd><div class="line-block">
<div class="line">Parallelization function uses LLVM OpenMP library as a default.</div>
<div class="line">If use the original  Fujitsu OpenMP library, specify  <code class="docutils literal notranslate"><span class="pre">-Nfjomplib</span></code> option.</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Standard template library (STL) change on C++03 style or C++11 style</dt><dd><p>If C++03 style or C++11 style, as STL, use libc++. At K, used STLport.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Translation option -f{signed-char|unsigned-char} omit value change</dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">-f{signed-char|unsigned-char}</span></code>option is omitted,  <code class="docutils literal notranslate"><span class="pre">-funsigned-char</span></code> option is applied abd predefined macro __SIGNED_CHARS__ is not defined.</p>
<p>If there is only a declaration of char type in the source program, the sign may change, and the operation of the program may be different from before.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Translation option -X abolished (language specification mode is GNU compatible mode only)</dt><dd><p>GNU C++ extention style is abusolutely enabled.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>GNU C++ compatible version change</dt><dd><p>Each macro value is as below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__GNUC__</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>__GNUC_MINOR__</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>__GNUC_PATCHLEVEL__</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>__GNUG__</p></td>
<td><p>6</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Omit value change of translation option -std</dt><dd><p>If omitted  <code class="docutils literal notranslate"><span class="pre">-std</span></code> option,  <code class="docutils literal notranslate"><span class="pre">-std=gnu++14</span></code> is applied.</p>
</dd>
</dl>
</li>
<li><p>Definition change of macro __STRICT_ANSI__ ,linux,unix, and __cplusplus</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Change contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__STRICT_ANSI__</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-std={c++98|c++03|c++11|c++14}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>linux</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-std={gnu++98|gnu++03|gnu++11|gnu++14}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-even"><td><p>unix</p></td>
<td><p>Defined if  <code class="docutils literal notranslate"><span class="pre">-std={gnu++98|gnu++03|gnu++11|gnu++14}</span></code> option is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>__cplusplus</p></td>
<td><p>Value will be 199711L if  <code class="docutils literal notranslate"><span class="pre">-std={c++98|c++03|gnu++98|gnu++03}</span></code> option is enabled.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>Operation change if specified translation option -Dname and -Uname at the same time</dt><dd><p>If specified the same name to  <code class="docutils literal notranslate"><span class="pre">-D</span></code> and  <code class="docutils literal notranslate"><span class="pre">-U</span></code>, the latst specification is enabled.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Omit value change of traslation option -N{line|noline}</dt><dd><p>When omitted  <code class="docutils literal notranslate"><span class="pre">-N{line|noline}</span></code> option,  <code class="docutils literal notranslate"><span class="pre">-Nline</span></code> option is applied.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Removal of translation option -K {openmp_tls | openmp_notls}</dt><dd><p>If specified  <code class="docutils literal notranslate"><span class="pre">-K{openmp_tls|openmp_notls}</span></code> option, the following alart message is output when translation.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : -Kopenmp_[no]tls  option is abolished.</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Style change of -Kswp and -Kswp_strong option</dt><dd><p>Specify  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code> behind of  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code>option,  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code> option is unabled and  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code> option is enabled.</p>
<p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kswp_strong</span></code> option, specify behind of  <code class="docutils literal notranslate"><span class="pre">-Kswp</span></code>,<code class="docutils literal notranslate"><span class="pre">-O2</span></code>,<code class="docutils literal notranslate"><span class="pre">-O3</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kfast</span></code> option.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>-Kdalign option abolish</dt><dd><p>Compile option  <code class="docutils literal notranslate"><span class="pre">-Kdalign</span></code> is unabled and alartted as following.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Alart : Sub option dalign, specified to -K is incorrect.</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Specification changes for built-in functions __sync_fetch_and_nand and __sync_nand_and_fetch</dt><dd><p>Changed to as following.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Built-in functions</p></th>
<th class="head"><p>Operation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type __sync_fetch_and_nand (type *ptr, type value, …)</p></td>
<td><div class="line-block">
<div class="line">tmp = *ptr;</div>
<div class="line">*ptr = ~(tmp &amp; value);</div>
<div class="line">return tmp;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>type __sync_nand_and_fetch (type *ptr, type value, …)</p></td>
<td><div class="line-block">
<div class="line">*ptr = ~(*ptr &amp; value);</div>
<div class="line">return *ptr;</div>
</div>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
<li><dl>
<dt>Change -Kprefetch_strong to default</dt><dd><p>The L1 prefetch instruction operates as a strong prefetch by default created by  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_sequential</span></code>, <code class="docutils literal notranslate"><span class="pre">-Kprefetch_stride</span></code> or  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_indirect</span></code>.</p>
<p>When generating a prefetch instruction that operates as a weak prefetch, specify  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>To enable -Kprefetch_nostrong and -Kprefetch_nostrong_L2 , -Khpctag is required.</dt><dd><p>To enable  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong</span></code> and  <code class="docutils literal notranslate"><span class="pre">-Kprefetch_nostrong_L2</span></code>,  <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is required. <code class="docutils literal notranslate"><span class="pre">-Khpctag</span></code> is enabled as a default.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Behavior change when an unrecognized option is specified</dt><dd><div class="line-block">
<div class="line">If an unrecognized option is specified, a warning message will be output and ignored.</div>
<div class="line">Previously, a warning message was output and passed to the linker.</div>
<div class="line">When passing options to the linker, use the <code class="docutils literal notranslate"><span class="pre">-Wl</span></code> option.</div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
<section id="mpi">
<h3><span class="section-number">8.4.4. </span>MPI<a class="headerlink" href="#mpi" title="Link to this heading">¶</a></h3>
<p>Please see “MPI User’s Guide” about the detail of each function indicated here.</p>
<ol class="arabic">
<li><dl class="simple">
<dt>Hasty Rendezvous communication function abolish</dt><dd><p>Cannot use MCA parameter pml_ob1_use_hasty_rendezvous.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MCA parameter dpm_ple_socket_timeout abolish</dt><dd><p>It is not possible to set the communication wait time between two MPI process groups that do not share a communicator such as dynamic processes.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Extention RDMA interface abolish</dt><dd><p>Revise to the program which uses uTofu interface.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Rank euery interface change</dt><dd><p>The functions have been consolidated into the following routines so that information on the node to which the child process is assigned can be obtained and the conventional routine functions can be used. For the specification, refer to “Rank Query Interface” in the manual “MPI User’s Guide”.</p>
<ul class="simple">
<li><p>FJMPI_TOPOLOGY_GET_COORDS</p></li>
<li><p>FJMPI_TOPOLOGY_GET_RANKS</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>C language MPI functions are not hooked by using Fortran profiling interface</dt><dd><p>When using the profiling interface in a Fortran program, you cannot hook using the C language interface.
When using the profiling interface in Fortran programs, hook using the Fortran interface.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Change to MCA parameter orte_abort_print_stack to opal_abort_print_stack</dt><dd><p>The MCA parameter orte_abort_print_stack for outputting stack trace information cannot be used. Change the MCA parameter to opal_abort_print_stack.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Change a parameter name of CA parameter dpm_ple_no_establish_connection</dt><dd><p>Correct the MCA parameter to mpi_no_establish_communication.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Change algorithm of reduction operation used in collective communication</dt><dd><p>The reduction operation steps is defferent when executed on K and executed on Fugaku.</p>
<p>For this reason, precision errors may occur in MPI_SUM reduction operations on floating-point or complex data, and the calculation results may differ.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>MCA parameter coll_tbi_use_on_max_min omit value change</dt><dd><p>Change MCA parameter coll_tbi_use_on_max_min omit value from 0 to 1.</p>
<p>By changing MCA parameter coll_tbi_use_on_max_min omit value from 0 to 1, the barrier communication is applied, and the calculation result may differ from the result without barrier communication.</p>
<ul class="simple">
<li><dl class="simple">
<dt>If NaN is included to the value to use calculation, please be awared of following.</dt><dd><ul>
<li><p>When barrier communication is applied, the result is a comparison of values other than NaN. However, if all values are NaN, it will be one of the NaN values.</p></li>
<li><p>If barrier communication is not applied, the result will be the result of comparing non-NaN values or one of the NaN values, depending on the execution conditions.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If both of +0.0 and -0.0 is included to the value to use calculation, please be awared of following.</dt><dd><ul>
<li><p>When applying barrier communication, compare by considering the sign of 0. (+0.0 &gt; -0.0)</p></li>
<li><p>If barrier communication is not applied, the sign of 0 is not considered.
Which one is selected in the magnitude comparison between +0.0 and -0.0 depends on the conditions at runtime.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>MCA parameter coll_tuned_use_6d_algorithm and coll_tuned_scatterv_use_linear_sync abolish</dt><dd><p>If you specify an obsolete MCA parameter, that specification is ignored. For this reason, the intended algorithm may not be selected and performance may not be achieved.</p>
<p>As an alternative to the elimination of these MCA parameters, use the function of algorithm selection for blocking collective communication.
Refer to “Tuning by Algorithm Selection” in the manual “MPI User’s Guide” for details on the function of algorithm selection for blocking collective communication.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Chaneg MCA parameter name about communication time out setting function</dt><dd><p>MCA parameter to specify wawiting communication time cut is opal_progress_timeout.</p>
<p>MCA parameter to specify when delaying program termination by the communication timeout setting function is opal_abort_delay.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MCA parameter mpi_deadlock_timeout and mpi_deadlock_timeout_delay abolish</dt><dd><p>MCA parameter  mpi_deadlock_timeout and mpi_deadlock_timeout_delay cannot be used. If specified these MCA parameters, communication time out setting function does not work.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Change the default value of the maximum number of processes that can communicate in high-speed communication mode</dt><dd><p>The default value of the maximum number of processes that can communicate in the high-speed communication mode is 256. In K, it was 1024.</p>
<p>For an MPI program in which the number of inter-node communication partner processes per process exceeds 256, the communication performance may decrease.
If there is enough available memory when executing the MPI program, specify a value greater than 256 for the MCA parameter common_tofu_max_fastmode_procs and execute the MPI program.</p>
</dd>
</dl>
</li>
</ol>
</section>
<section id="tool">
<h3><span class="section-number">8.4.5. </span>Tool<a class="headerlink" href="#tool" title="Link to this heading">¶</a></h3>
<p>The incompetible items about the tool is as following.</p>
<ol class="arabic">
<li><dl class="simple">
<dt>Interactive debugger abolish</dt><dd><p>Cannot use interactive executable debugger using GUI.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Debugger engine (fdb) abolish</dt><dd><p>Use  <strong class="command">gdb</strong> for the debugger.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Tracer abolish</dt><dd><p>Cannot use a tracer.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Tofu PA abolish</dt><dd><p>Cannot use Tofu PA.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Instant Performance Profiler information (GUI style) abolish</dt><dd><p>Use text style.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Advanced Performance Profiler information (GUI style) abolish</dt><dd><p>Use text style, CSV style, XML style or CPU performance analiyzing report.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Change Advanced Performance Profiler precision PA visualization function (Excel style) to CPU performance analiyzing report</dt><dd><p>Already changed “Advanced Performance Profiler precision PA visualization function (Excel style)” to “CPU performance analiyzing report”.</p>
<p>Notes on CPU performance analiyzing report is as following.</p>
<ul class="simple">
<li><p>Requires to proceed measurement by Advanced Performance Profiler and file output for 5 times, 11 times or 17 times.</p></li>
<li><p>Excel style report file prepares only English index.</p></li>
<li><p>On CPU performance analiyzing report (Excel style), output information by CMG unit. Outputs up to 12 threads of information to one Excel file. Therefore, if the number of threads in one process is less than 12, the information of another process in the same CMG unit may be displayed together.</p></li>
<li><p>Depending on CPU change, the difference on obtainable event information occurs. Thus, the calculation target information is changed.</p></li>
<li><dl class="simple">
<dt>Precision PA’s following items will not be output.</dt><dd><ul>
<li><p>SIMD calculation related information</p></li>
<li><p>Concatenation shift instruction rate</p></li>
<li><p>Permutation instruction rate</p></li>
<li><p>L2 throughput</p></li>
<li><p>MINOPS</p></li>
<li><p>Integer operation</p></li>
<li><p>Load balance and instruction balance</p></li>
<li><p>Rate on program execution time</p></li>
<li><p>Number of passing in measurement section and average execution time</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Core bind when using Advanced Performance Profiler</dt><dd><p>When using Advanced Performance Profiler, change to make core bind specification is required. When using Advanced Performance Profiler, specify core bind.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>start_collection function and stop_collection function abolish</dt><dd><p>If inputting start_collection function and stop_collection function into a source code, change to fapp_start function and fapp_stop function.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Operation change if specified fipp command and fapp command -H option and -I{cpupa|nocpupa} option at the same time</dt><dd><p>If specified  <code class="docutils literal notranslate"><span class="pre">-H</span></code> option and  <code class="docutils literal notranslate"><span class="pre">-Inocpupa</span></code> option by  <strong class="program">fipp</strong> command and  <strong class="program">fapp</strong> command at the same time, regardless of the specified order, always  <code class="docutils literal notranslate"><span class="pre">-I{cpupa|nocpupa}</span></code> option is enabled. Also, if not specify  <code class="docutils literal notranslate"><span class="pre">-I{cpupa|nocpupa}</span></code> option and specified  <code class="docutils literal notranslate"><span class="pre">-H</span></code> option, <code class="docutils literal notranslate"><span class="pre">-Icpupa</span></code> option is enabled.</p>
<p>If you want to enable  <code class="docutils literal notranslate"><span class="pre">-H</span></code> option,  do not specify  <code class="docutils literal notranslate"><span class="pre">-Inocpupa</span></code> option.</p>
</dd>
</dl>
</li>
</ol>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">8. Migration from K</a><ul>
<li><a class="reference internal" href="#overview">8.1. Overview</a></li>
<li><a class="reference internal" href="#language-environment-correspondance">8.2. Language environment correspondance</a></li>
<li><a class="reference internal" href="#version-check-method">8.3. Version check method</a></li>
<li><a class="reference internal" href="#incompatible-item">8.4. Incompatible item</a><ul>
<li><a class="reference internal" href="#fortran">8.4.1. Fortran</a></li>
<li><a class="reference internal" href="#c-language">8.4.2. C language</a></li>
<li><a class="reference internal" href="#c">8.4.3. C++</a></li>
<li><a class="reference internal" href="#mpi">8.4.4. MPI</a></li>
<li><a class="reference internal" href="#tool">8.4.5. Tool</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../ScriptingLanguage/index.html"
                          title="previous chapter"><span class="section-number">7. </span>Script language</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../ScriptingLanguage/index.html" title="7. Script language"
             >previous</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Supercomputer Fugaku User Guide －Language and development environment－  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8. </span>Migration from K</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, RIKEN Center for Computational Science.
    &nbsp;&nbsp;<a href="https://www.fugaku.r-ccs.riken.jp/en/">Fugaku website Top</a>
    </div>
  </body>
</html>