

<!doctype html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8.5. Shared temporary area &#8212; Supercomputer Fugaku User Guide - Use and job execution -  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=532c1bf3" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f85107c5" />
    
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.6. Important Notices" href="LLIOconsiderpoints.html" />
    <link rel="prev" title="8.4. Node Temporary Area" href="TemporaryAreaInNode.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="LLIOconsiderpoints.html" title="8.6. Important Notices"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="TemporaryAreaInNode.html" title="8.4. Node Temporary Area"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Supercomputer Fugaku User Guide - Use and job execution -  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span class="section-number">8. </span>Layered storage</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8.5. </span>Shared temporary area</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="shared-temporary-area">
<span id="sharedtemporaryarea"></span><h1><span class="section-number">8.5. </span>Shared temporary area<a class="headerlink" href="#shared-temporary-area" title="Link to this heading">¶</a></h1>
<p>The first-layer storage can be shared and used within the same job.</p>
<p>The shared temporary area can be shared between multiple compute nodes within the same job. The shared temporary area will be available at the start of the job and will not be available at the end of the job. Therefore, users need to place files that they want to save, such as job execution result files, in the second-layer storage cache area or 2ndfs area.</p>
<ol class="arabic simple">
<li><p>The shared temporary area can be shared by multiple compute nodes in a job.</p></li>
<li><p>The shared temporary area becomes available at the start of the job and is erased at the end of the job. Save such as job execution result files must be placed on the second-layer storage cache area or 2ndfs area.</p></li>
<li><p>To use the shared temporary area, specify an arbitrary area size with  <code class="docutils literal notranslate"><span class="pre">--llio</span> <span class="pre">sharedtmp-size</span></code> in the option of the <strong class="program">pjsub</strong> command when submitting a job.</p></li>
<li><p>The path name of the shared temporary area can be referenced in the job by the environment variable  <code class="docutils literal notranslate"><span class="pre">${PJM_SHAREDTMP}</span></code> .</p></li>
</ol>
<figure class="align-default">
<img alt="../_images/SharedTemporaryArea_01.png" src="../_images/SharedTemporaryArea_01.png" />
</figure>
<ol class="arabic" start="5">
<li><p>Here describes shared temporary area style.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Shared temporary area style</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Item</p></th>
<th class="head"><p>Characteristic</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reference area</p></td>
<td><p>Able to refer the within compute node that assigne to job. Able to refer from the multiple compute node if in the same job.</p></td>
</tr>
<tr class="row-odd"><td><p>Lifetime</p></td>
<td><p>Initialized before job starts and deleted after job closing.</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<section id="stripe-setting-for-shared-temporary-area">
<span id="stripesettingforsharedtemporaryarea"></span><h2><span class="section-number">8.5.1. </span>Stripe setting for shared temporary area<a class="headerlink" href="#stripe-setting-for-shared-temporary-area" title="Link to this heading">¶</a></h2>
<p>File access bandwidth is increased by distributing the shared temporary area across multiple first-layer devices.
When submitting a job, the user specifies the stripe size and stripe count according to the I / O characteristics of the application.
This allows efficient access to the shared temporary area.</p>
<figure class="align-default">
<img alt="../_images/StripeSettingForSharedTemporaryArea_01.png" src="../_images/StripeSettingForSharedTemporaryArea_01.png" />
</figure>
<p>This indicates the example about setting stripe count 3.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Area name</p></th>
<th class="head"><p>Lfs command</p></th>
<th class="head"><p>pjsub –llio option</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shared temporary area</p></td>
<td><p>－</p></td>
<td><p>✓</p></td>
</tr>
</tbody>
</table>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pjsub<span class="w">  </span>--llio<span class="w">  </span>stripe-count<span class="o">=</span><span class="m">3</span><span class="w">  </span>jobscript.sh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>There are currently 24 up and down stripe counts that can be set.</p></li>
<li><p>LLIO stripe count defaults to 24.</p></li>
</ul>
</div>
</section>
<section id="shared-temporary-area-size">
<h2><span class="section-number">8.5.2. </span>Shared temporary area size<a class="headerlink" href="#shared-temporary-area-size" title="Link to this heading">¶</a></h2>
<div class="line-block">
<div class="line">When using shared temporary area, that size can be specified when job submission.</div>
<div class="line">Specify “size of shared temporary area ÷ number of allocated nodes” in the parameter  <code class="docutils literal notranslate"><span class="pre">sharedtmp-size</span></code>  of the  <code class="docutils literal notranslate"><span class="pre">--llio</span></code> option of the <strong class="program">pjsub</strong> command. If you do not specify a size, It will be the default value (0MiB) set in the system.</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Area name</p></th>
<th class="head"><p>Option</p></th>
<th class="head"><p>Specification value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shared temporary area</p></td>
<td><p>–llio sharedtmp-size</p></td>
<td><p>Shared temporary area size ÷ Number of job assign node</p></td>
</tr>
</tbody>
</table>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<ul>
<li><div class="line-block">
<div class="line">The value specified by the parameter sharedtmp-size is not the size of the entire shared temporary area that can be used by the job. The size of the entire shared temporary area is the value obtained by multiplying the value specified by the parameter sharedtmp-size by the number of nodes allocated to the job.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Even though you do not run out of all the available space of the shared temporary area specified when the job was submitted, you may encounter errors due to insufficient free space.</div>
<div class="line">This may be because a job uses more than one storage I/O node and runs out of available space on one storage I/O node.</div>
<div class="line">If this occurs, increase the amount of shared temporary space and run the job.</div>
</div>
</li>
</ul>
</div>
<p>At least 128MiB must be assigned to <a class="reference internal" href="TheSecondLayerStrage.html#volumeofstrage"><span class="std std-ref">The Cache Area of Second-Layer Storage size</span></a>. Please specify the size so that it meets the following.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">128</span><span class="n">MiB</span> <span class="o">&lt;=</span> <span class="mi">87</span><span class="n">GiB</span> <span class="o">-</span> <span class="p">(</span><span class="n">localtmp</span><span class="o">-</span><span class="n">size</span> <span class="o">+</span> <span class="n">sharedtmp</span><span class="o">-</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-to-use">
<h2><span class="section-number">8.5.3. </span>How to use<a class="headerlink" href="#how-to-use" title="Link to this heading">¶</a></h2>
<p>By specifying option when job submission, shared temporary aea can be used.</p>
<ol class="arabic">
<li><p>Submit a job.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pjsub<span class="w"> </span>--llio<span class="w"> </span>sharedtmp-size<span class="o">=</span>size<span class="w">   </span>jobscript.sh
</pre></div>
</div>
</li>
<li><p>Shared temporary area’s path name (directory name) is set to an environmental change PJM_SHAREDTMP.</p>
<p>It is checkable with environment variables PJM_SHAREDTMP which is set in the job. The following is an example of a simple job that uses a shared temporary area as a temporary data storage destination.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>prog1 -o ${PJM_SHAREDTMP}/out.data
</pre></div>
</div>
</li>
<li><p>Program prog2 reads file out.data and output the final computed result result.data to directory${PJM_SHAREDTMP}.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>prog2 -i ${PJM_SHAREDTMP}/out.data -o ${PJM_SHAREDTMP}/result.data
</pre></div>
</div>
</li>
<li><p>Before ending the job, save the file result.data in the directory $ {PJM_JOBDIR} (on the global file system) at the time of job execution with the job ID $ {PJM_JOBID} appended.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cp<span class="w"> </span><span class="si">${</span><span class="nv">PJM_SHAREDTMP</span><span class="si">}</span>/result.data<span class="w"> </span><span class="si">${</span><span class="nv">PJM_JOBDIR</span><span class="si">}</span>/result_<span class="si">${</span><span class="nv">PJM_JOBID</span><span class="si">}</span>.data
</pre></div>
</div>
</li>
</ol>
</section>
<section id="job-submitting-option-pjsub-llio">
<h2><span class="section-number">8.5.4. </span>Job submitting option (pjsub –llio)<a class="headerlink" href="#job-submitting-option-pjsub-llio" title="Link to this heading">¶</a></h2>
<p>Here describes the option related to shared temporary area.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37.5%" />
<col style="width: 62.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>pjsub option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sharedtmp-size=size</p></td>
<td><div class="line-block">
<div class="line">Specify shared temporary area size.(Default 0Mi)</div>
<div class="line">Shared temporary area path name is set to environment variable${PJM_SHAREDTMP} in a job.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>stripe-count=count</p></td>
<td><div class="line-block">
<div class="line">Specify the number of stripes per file when distributing files in the shared temporary area.(Default 24)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>stripe-size=size</p></td>
<td><div class="line-block">
<div class="line">Specify the stripe size when distributing files in the shared temporary area.(Default 2048Ki)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>async-close={on|off}</p></td>
<td><div class="line-block">
<div class="line">Specifies whether to close the shared temporary area asynchronously or not.</div>
<div class="line">Specifying synchronous / asynchronous close from the cache in the compute node to the first-layer storage</div>
<div class="line"><br /></div>
<div class="line">on: Asynchronous close</div>
<div class="line">off: Synchronous close (Default value)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>perf[,perf-path=path]</p></td>
<td><div class="line-block">
<div class="line">Output LLIO performance information to the file.</div>
<div class="line">The output destination is under the current directory when the job is submitted, and the file name is the name defined by the job ACL function. Also with the parameter perf-path, target output file can be specified.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<ul>
<li><div class="line-block">
<div class="line">The (default value) may be changed for each resource group depending on the operating conditions. The current default value can be checked with the pjacl --rg &lt;resource group name&gt; command.</div>
</div>
</li>
</ul>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">8.5. Shared temporary area</a><ul>
<li><a class="reference internal" href="#stripe-setting-for-shared-temporary-area">8.5.1. Stripe setting for shared temporary area</a></li>
<li><a class="reference internal" href="#shared-temporary-area-size">8.5.2. Shared temporary area size</a></li>
<li><a class="reference internal" href="#how-to-use">8.5.3. How to use</a></li>
<li><a class="reference internal" href="#job-submitting-option-pjsub-llio">8.5.4. Job submitting option (pjsub –llio)</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="TemporaryAreaInNode.html"
                          title="previous chapter"><span class="section-number">8.4. </span>Node Temporary Area</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="LLIOconsiderpoints.html"
                          title="next chapter"><span class="section-number">8.6. </span>Important Notices</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="LLIOconsiderpoints.html" title="8.6. Important Notices"
             >next</a></li>
        <li class="right" >
          <a href="TemporaryAreaInNode.html" title="8.4. Node Temporary Area"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Supercomputer Fugaku User Guide - Use and job execution -  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">8. </span>Layered storage</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">8.5. </span>Shared temporary area</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, RIKEN Center for Computational Science.
    &nbsp;&nbsp;<a href="https://www.fugaku.r-ccs.riken.jp/en/">Fugaku website Top</a>
    </div>
  </body>
</html>