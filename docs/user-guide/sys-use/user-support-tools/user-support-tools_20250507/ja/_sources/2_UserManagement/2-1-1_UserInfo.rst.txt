ユーザ情報表示
===============

| 　**[名前]**
| 　userinfo - ユーザ情報を表示する

| 　**[書式]**
| 　userinfo  [-u  ユーザ名...]  [-u, -l以外のオプション]
| 　userinfo  -l
| 　※-u, -i, -g, -n, -y, -hの複合指定はAND検索、同一オプション内での複数指定はOR検索になる。

| 　**[説明]**
| 　userinfo コマンドは、利用者管理ノード上のディレクトリサービス(OpenLDAP)に登録されている利用者の情報を表示する。表示結果が複数行に及ぶ場合はディレクトリサービス(OpenLDAP)から取り出された順に表示される。

| 　利用者は自身の利用者情報のみ表示可能である。プロジェクト責任者はグループに属するメンバの利用者情報を表示可能である。システム管理者はシステムに登録されている全メンバの利用者情報を表示可能である。ただし、利用者管理機能に記載されている管理者権限が付与されている必要がある。なお、オプション指定なしの場合はプロジェクト責任者、システム管理者であっても自身の利用者情報のみ表示可能である。
 　
| 　個人情報については、「個人情報表示」もしくは「個人情報設定」権限が付与されている管理者のみ表示が可能となる。ただし、「個人情報表示」もしくは「個人情報設定」権限が付与されていなくても、自身の個人情報は表示される。
 　
| 　ステータスの状態が「削除」以外の利用者情報が表示対象になる。

.. list-table:: 
  :header-rows: 1
  :widths: 10 10 60

  * - ステータス
    - 状態
    - 意味

  * - 0
    - 有効
    - システム利用が可能な状態である。

  * - 1
    - ロック
    - 利用者がログイン時のパスワード入力を規定回数以上誤ったことによりロックされている状態である。この状態は、システム利用が不可能な状態である。

  * - 2
    - ロック
    - システム管理者の判断によりロックされている状態である。この状態は、システム利用が不可能な状態である。

  * - 3
    - 削除
    - システム管理者の判断により論理削除されている状態である。この状態は、システム利用が不可能な状態である。

  * - 4
    - 猶予期間中
    - システムの自動判断により猶予期間に設定されている状態である。この状態は、利用者ポータル、\ |post-k|\ のログインノードへのSSH接続は可能であるが、ジョブの投入は不可能な状態である。

  * - 5
    - 有効期間外
    - システムの自動判断により有効期間外に設定されている状態である。この状態は、利用者ポータル、ログインノードへのSSH接続、ジョブの投入が不可能な状態である。

| 　**[オプション]**
| 　-u  ユーザ名...
| 　ユーザ名を指定する。スペースに続けて複数指定が可能で、アスタリスクを使用した前方／中間／後方一致指定ができる。全ユーザの情報を表示する場合には、-uオプションの引数に ‘*’ を指定する。
| 　完全一致指定	user
| 　前方一致指定	‘user*’
| 　中間一致指定	’\*user*’
| 　後方一致指定	’\*user’
 　
| 　-i  ユーザID...
| 　ユーザIDを指定する。スペースに続けて複数指定が可能であるが、アスタリスクを使用した前方／中間／後方一致指定はできない。完全一致指定のみ可能である。
 　
| 　-g  グループ名...
| 　グループ名を指定する。スペースに続けて複数指定が可能で、アスタリスクを使用した前方／中間／後方一致指定ができる。
| 　完全一致指定	group
| 　前方一致指定	’group \*’
| 　中間一致指定	’* group \*’
| 　後方一致指定	’\* group’
 　
| 　-n  氏名...
| 　氏名を指定する。スペースに続けて複数指定が可能で、アスタリスクを使用した前方／中間／後方一致指定ができる。
| 　完全一致指定	“富岳　太郎”
| 　前方一致指定	“富岳*”
| 　中間一致指定	“\*富岳\*”
| 　後方一致指定	“\*太郎”
 　
| 　-y  氏名フリガナ...
| 　氏名の振り仮名を指定する。スペースに続けて複数指定が可能で、アスタリスクを使用した前方／中間／後方一致指定ができる。
| 　完全一致指定	“フガク　タロウ”
| 　前方一致指定	“フガク*”
| 　中間一致指定	“\*フガク\*”
| 　後方一致指定	“\*タロウ”
 　
| 　-h  HPCI-ID...
| 　HPCI-IDを指定する。スペースに続けて複数指定が可能で、アスタリスクを使用した前方／中間／後方一致指定ができる。
| 　完全一致指定	“ hpci120000”
| 　前方一致指定	“hp*”
| 　中間一致指定	“\*12\*”
| 　後方一致指定	“\*000”
 　
| 　-l
| 　全ユーザ名の一覧を表示する。他オプションとは排他の関係にある。
 　
| 　出力形式は
| 　ユーザ名：ユーザID
| 　となる。
 　
| 　-d
| 　ディスク容量の制限情報を表示する。
 　
| 　-p
| 　管理者権限の情報を表示する。
 　
| 　-s
| 　全項目を表示する詳細モードである。-d, -pの同時指定と等価になる。
 　
| 　-c
| 　CSV形式にて標準出力に表示する。ファイルに出力したい場合にはリダイレクトを使用する。
 　
| 　--help
| 　コマンドのヘルプ内容を表示する。
 　
| 　**[復帰値]**
| 　正常時: 0
| 　異常時: 1

| 　**[備考]** 
| 　なし。

| 　**[使用例]**
| 　【例1】	ユーザ名fjse0100の利用者情報を任意のオプションを指定せずに表示する

.. figure:: img/2_UserManagement_04.png

| 　【例2】	ユーザ名fjse0100の利用者情報にディスク容量の制限情報と管理者権限の情報も付加して表示する

.. figure:: img/2_UserManagement_05.png

| 　ユーザディスク情報には、ユーザのquotaが設定されているスライス分だけ表示される。
 　
| 　【例3】	全ユーザのユーザ名、ユーザIDを一覧表示する

.. code-block:: console 

   [login]$ userinfo -l
   fjse0100:1100
   fjse0101:1101
   [login]$

| 　全てのユーザ名、ユーザIDが一覧表示される。
 
| 　【例4】	ユーザ名fjse0100, fjse0101の利用者情報をCSV形式で表示する

.. figure:: img/2_UserManagement_06.png

| 　引数としてアスタリスクを使用する際には、シェルが特殊文字として解釈しないように注意する必要がある。
| 　特殊文字として解釈しないように以下を使用する。

- バックスラッシュ( \\ )により一文字エスケープ
- シングルクォーテーション( ‘ )で囲む
- ダブルクォーテーション( “ )で囲む

| 　【例5】	ユーザ名fjse0100, fjse0101の利用者情報をCSV形式でファイル出力する

.. code-block:: console 

   [login]$ userinfo -u ‘fjse010*’ -c > fjse010X.csv
   [login]$

| 　fjse010* で表現される複数ユーザの利用者情報を、CSV形式でファイル fjse010X.csv に出力したものである。
 　
| 　【例6】	ユーザ名fjse0100のシステム利用可否状態を確認する

.. figure:: img/2_UserManagement_07.png

| 　システムの利用可否状態は、 userinfo コマンドの実行結果中の 'status' 情報により確認できる。
 　
| 　【例7】	ユーザ情報変更で使用するCSV形式のファイルを作成する

.. code-block:: console 

   [login]$ userinfo -u fjse0100 -s -c > fjse0100.csv
   [login]$

| 　全項目を表示する詳細モードの-sオプションとCSV形式にて標準出力に表示する-cオプションを指定し、リダイレクション機能を使用することでファイルに保存する。-sオプションを指定しないと、ディスク容量制限、管理者権限の情報がNULLで出力されてしまう。
 　 
| 　表示項目の説明を示す。

.. .. figure:: img/2_UserManagement_08_1.png

.. .. figure:: img/2_UserManagement_08_2.png

.. .. figure:: img/2_UserManagement_08_3.png

.. figure:: img/2_UserManagement_08_4.png

| 　[\*1] 表示形式：課題開始日(YYYYMMDD)-課題終了日(YYYYMMDD)
 　　
| 　例）20220101-20220331
 　　
| 　　所属する課題の開始日が2022年1月1日で、終了日が2022年3月31日となる。
 　　
| 　[\*2] アカウントエントリは利用者とプロジェクト責任者が表示可能
| 　　　個人情報エントリは利用者自身のみ表示可能

