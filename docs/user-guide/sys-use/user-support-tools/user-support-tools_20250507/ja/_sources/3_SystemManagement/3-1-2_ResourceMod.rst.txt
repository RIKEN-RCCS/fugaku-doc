割当リソース変更
=================

| 　**[名前]**
| 　resourcemod - リソースタイプ毎に設定した制限値を拡張・縮小する

| 　**[書式]**
| 　resourcemod  -g  グループ名  [-u  ユーザ名] [-rscgrp  リソースグループ名] [-resource  リソース値] [-distrsc  期毎配分資源量]
| 　resourcemod  -f  ファイル名

| 　**[説明]**
| 　resourcemod コマンドは、グループ、リソースグループや利用者毎に設定した計算リソース枠を変更する場合に使用する。変更形式には、1件の計算リソース枠を変更する単一形式と複数の計算リソース枠を一括して変更するCSV形式がある。
| 　設定済の計算リソース枠を"unlimited"に戻す場合は、"-resource"オプションの指定を省略します。
| 　初めて計算リソース枠の設定を行う、かつジョブ投入の実績が無い条件についてはresourceaddコマンドを使用します。
| 　既に計算リソース枠が設定されているか、ジョブ投入されているかを確認する場合は、accountjコマンドを使用し、対象条件の状況を確認します。
| 　対象の情報行が存在する場合は当コマンドの対象となります。

.. code-block:: console

   【例】$ accountj -g group01 -E

| 　なお、resourcemodコマンド設定後の状況確認も上記accountjコマンドで行います。


.. figure:: img/3_SystemManagement_03.png

| 　なお、計算リソースの割当枠とは、課題選定時に利用者からの申請に従い登録機関が割り当てる計算リソース枠のことである。利用者はこの枠を超えて、\ |post-k|\  でジョブ投入、実行することはできない。

| 　テーマ管理者、サブテーマ管理者はサブテーマのリソースをグループに対して設定することができる。
| 　テーマ管理者、サブテーマ管理者、プロジェクト責任者は課題の割当リソースをグループより下の階層（上記図のリソースグループ、ユーザの階層）に対して設定することができる。ただし、グループ配下のリソースグループ単体への制限値についてはシステム管理者のみ設定が可能である。
| 　なお、一般利用者については当該コマンドを利用できない。

| 　**[オプション]**
| 　-g  グループ名
| 　グループ名を指定する。

| 　-u  ユーザ名
| 　ユーザ名を指定する。
 　
| 　-rscgrp  リソースグループ名
| 　リソースグループ名を指定する。
 　
| 　-resource  割当リソース
| 　変更したい計算リソース枠（ノード数×経過時間制限値）を指定する。正の整数値を指定する。数値の単位はノード秒[node･s]で、0（ゼロ）を指定した場合は使用禁止となる。
| 　設定した予算枠を"unlimited"に戻す場合は当オプションの指定を省略する。
 　
| 　-distrsc  期毎配分資源量
| 　期毎配分資源量を指定する。グループに対して更新を行う場合に有効で、その他の場合は無視される。グループに対する期毎配分資源量は繰り越し処理に影響しない。
 　
| 　-f  ファイル名
| 　課題の割当リソースをジョブタイプ、利用者に分配済みの場合において、予算枠もしくはジョブタイプリソース名を変更するための情報が記載されたファイルを指定する。
 　
| 　【ファイルレイアウト】
| 　必須欄　○：必須、△：リソースタイプにより必須有無が決定される

   .. list-table:: 
     :header-rows: 1
     :widths: 5 20 20 5 30
   
     * - No
       - 項目名
       - 属性
       - 必須
       - 備考
   
     * - 1
       - RTYPE
       - 半角英字
       - ○
       - | リソースタイプ
         | グループ：GROUP
         | ユーザ：USER
         | リソースグループ：RSCG
         | ユーザ-リソースグループ：USER_RSCG
   
     * - 2
       - GROUP
       - 半角英数字記号
       - ○
       - グループ名
   
     * - 3
       - USER
       - 半角英数字
       - △
       - | ユーザ名
         | リソースグループ指定時はNULL
   
     * - 4
       - RSCGRP
       - 半角英数字
       - △
       - | リソースグループ名
         | ユーザ指定時はNULL
   
     * - 5
       - LIMIT
       - 数字
       - 
       - | 計算リソース枠
         | （ノード数×経過時間制限値）
         | ※正の整数値を指定する。数値の単位はノード秒[node･s]で、0（ゼロ）を指定した場合は使用禁止となる。
   
     * - 6
       - DISTRSC
       - 半角英数字記号
       - 
       - | 期毎配分資源量
         | 期間の範囲と、その期間の資源量を指定する。
         | 指定例
         | 20190401-20190930:100,20191001-20200331:200

| 　【ファイル設定例】
| 　・割当リソース枠を変更する場合

.. code-block:: console

   RTYPE,GROUP,USER, RSCGRP,LIMIT,DISTRSC　・・・ヘッダ
   GROUP,group01,,,100,　・・・グループに対する割当
   USER,group01,user1,,100,　・・・ユーザに対する割当
   RSCG,group01,,rg1,100,　・・・リソースグループに対する割当
   USER_RSCG,group01,user1,rg1,100,　・・・ユーザとリソースグループの組み合わせに対する割当

| 　--help
| 　コマンドのヘルプ内容を表示する。

| 　**[復帰値]**
| 　正常時: 0
| 　異常時: 1

| 　**[備考]**
| 　なし。

| 　**[使用例]**
| 　【例1】	グループの制限値を変更する

.. code-block:: console 

   [login]$ resourcemod -g group01 -resource 100
   1件のリソース情報を更新しました。
   [login]$

　【例2】	ユーザの制限値を変更する

.. code-block:: console 

   [login]$ resourcemod -g group01 -u user1 -resource 100
   1件のリソース情報を更新しました。
   [login]$

　【例3】	ユーザとリソースグループの組み合わせの制限値を変更する

.. code-block:: console 

   [login]$ resourcemod -g group01 -u user1 –rscgrp rg1 -resource 100
   1件のリソース情報を更新しました。
   [login]$

　【例4】	複数の条件に対して一括して制限値を変更する

.. code-block:: console 

   [login]$ resourcemod -f resourcemod.csv
   4件のリソース情報を更新しました。
   [login]$

