割当リソース登録
==================

| 　**[名前]**
| 　resourceadd - 計算リソースの制限値を設定する

| 　**[書式]**
| 　resourceadd  -g  グループ名 [-u  ユーザ名] [-rscgrp  リソースグループ名] [-resource  リソース値]
| 　resourceadd  -f  ファイル名
 　
| 　**[説明]**
| 　resourceadd コマンドは、サブテーマに割り当てられている計算リソースを、リソースグループやユーザ単位でさらに制限値を設定する。設定することでリソースグループやユーザでの予算枠（上限値）が設定できる。登録形式には、1件の課題に対して計算リソースを分配する単一形式と複数の課題に対して一括して設定するCSV形式がある。
| 　初めて計算リソース枠の設定を行う条件については当コマンドを使用しますが、既に設定済の値の変更を行う場合や、既にジョブ投入の実績がある条件に計算リソース枠を設定する場合はresourcemodコマンドを使用します。
| 　既に計算リソース枠が設定されているか、ジョブ投入されているかを確認する場合は、accountjコマンドを使用し、対象条件の状況を確認します。
| 　対象の情報行が存在しない場合は当コマンドの対象となります。

.. code-block:: console

   【例】$ accountj -g group01 -E

| 　なお、resourceaddコマンド設定後の状況確認も上記accountjコマンドで行います。


.. figure:: img/3_SystemManagement_02.png

| 　なお、計算リソースの割当枠とは、課題選定時に利用者からの申請に従い登録機関が割り当てる計算リソース枠のことである。利用者はこの枠を超えて、\ |post-k|\  でジョブ投入、実行することはできない。

| 　テーマ管理者、サブテーマ管理者、プロジェクト責任者は課題の割当リソースをグループより下の階層（上記図のリソースグループ、ユーザの階層）に対して設定することができる。ただし、リソースグループ単体へのリソース枠についてはシステム管理者のみ設定が可能である。
| 　なお、一般利用者については当該コマンドを利用できない。

| 　**[オプション]**
| 　-g  グループ名
| 　グループ名を指定する。

| 　-resource  リソース値
| 　上限値となる計算リソース枠（ノード数×経過時間制限値）を指定する。正の整数値で指定する。数値の単位はノード秒[node･s]で、0（ゼロ）を指定した場合は使用禁止となる。
 　
| 　-u  ユーザ名
| 　ユーザ名を指定する。
 　
| 　-rscgrp  リソースグループ名
| 　計算リソースの使用を制限したいリソースグループ名を指定する。
 　
| 　【ファイルレイアウト】
| 　必須欄　○：必須、△：リソースタイプにより必須有無が決定される

   .. list-table:: 
     :header-rows: 1
     :widths: 5 20 20 5 30
   
     * - No
       - 項目名
       - 属性
       - 必須
       - 備考
   
     * - 1
       - RTYPE
       - 半角英字
       - ○
       - | リソースタイプ
         | ユーザ：USER
         | リソースグループ：RSCG
         | ユーザ-リソースグループ：USER_RSCG
   
     * - 2
       - GROUP
       - 半角英数字記号
       - ○
       - グループ名
   
     * - 3
       - USER
       - 半角英数字
       - △
       - | ユーザ名
         | リソースグループ指定時はNULL
   
     * - 4
       - RSCGRP
       - 半角英数字
       - △
       - | リソースグループ名
         | ユーザ指定時はNULL
   
     * - 5
       - LIMIT
       - 数字
       - ○
       - | 計算リソース枠
         | （ノード数×経過時間制限値）
         | ※正の整数値を指定する。数値の単位はノード秒[node･s]で、0（ゼロ）を指定した場合は使用禁止となる。

　【ファイル設定例】

.. code-block:: none 

   RTYPE,GROUP,USER,RSCGRP,LIMIT　・・・ヘッダ
   USER,group01,user1,,100　・・・ユーザに対する割当
   RSCG,group01,,rg1,100　・・・リソースグループに対する割当
   USER_RSCG,group01,user1,rg1,100　・・・ユーザとリソースグループの組み合わせに対する割当

| 　--help
| 　コマンドのヘルプ内容を表示する。

| 　**[復帰値]**
| 　正常時: 0
| 　異常時: 1

| 　**[備考]**
| 　なし。

| 　**[使用例]**
| 　【例1】	ユーザに制限値を設定する

.. code-block:: console 

   [login]$ resourceadd -g group01 -u user1 -resource 100
   1件のリソース情報を登録しました。
   [login]$

　【例2】	ユーザとリソースグループの組み合わせに制限値を設定する

.. code-block:: console 

   [login]$ resourceadd -g group01 -u user1 –rscgrp rg1 -resource 100
   1件のリソース情報を登録しました。
   [login]$

　【例3】	複数の条件に対して一括して制限値を設定する

.. code-block:: console 

   [login]$ resourceadd -f resourceadd.csv
   4件のリソース情報を登録しました。
   [login]$
