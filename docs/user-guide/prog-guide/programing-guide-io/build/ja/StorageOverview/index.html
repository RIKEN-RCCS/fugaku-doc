

<!doctype html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
    <link rel="icon" href="/fugaku/docs/img/favicon.ico">

    <title>2. ストレージの概要 &#8212; プログラミングガイド IO編  ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="3. 容量設定" href="../CapacitySetting/index.html" />
    <link rel="prev" title="1. はじめに" href="../Introduction/index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../CapacitySetting/index.html" title="3. 容量設定"
             accesskey="N">次へ</a></li>
        <li class="right" >
          <a href="../Introduction/index.html" title="1. はじめに"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">プログラミングガイド IO編  ドキュメント</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span>ストレージの概要</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="id1">
<h1><span class="section-number">2. </span>ストレージの概要<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h1>
<p>ストレージの概要について説明します。</p>
<section id="id2">
<h2><span class="section-number">2.1. </span>ジョブ投入の流れ<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">¶</a></h2>
<p>利用者は、ログインノードにログインし、FEFSへのファイルの配置ならびにジョブの実行を依頼することにより、計算ノード側においてジョブを実行できます。</p>
<ul class="simple">
<li><p>ジョブ実行中は、必要に応じてFEFSからファイルの読み書きを行います。</p></li>
<li><p>ジョブ終了後、利用者はログインノードからジョブ実行中に出力されたファイルを参照できます。</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/JobSubmission_01.png" src="../_images/JobSubmission_01.png" />
</figure>
</section>
<section id="id3">
<h2><span class="section-number">2.2. </span>「富岳」のストレージの構成概要<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">¶</a></h2>
<p>「富岳」のストレージは、高速アクセスを可能とする第1階層ストレージと、データ保管可能な第2階層ストレージから構成されています。</p>
<figure class="align-default">
<img alt="../_images/OverView_01.png" src="../_images/OverView_01.png" />
</figure>
<section id="id4">
<h3><span class="section-number">2.2.1. </span>「富岳」で利用可能なファイルシステム<a class="headerlink" href="#id4" title="この見出しへのパーマリンク">¶</a></h3>
<p>「富岳」では、以下の2種類のファイルシステムを利用できます。</p>
<ul>
<li><p>FEFS (Fujitsu Exabyte Filesystem)：第2階層ストレージ</p>
<p>「京」で開発されたファイルシステムであり、ディスク装置で構成されています。大容量のデータや長期保管するデータに適しています。</p>
</li>
<li><p>LLIO (Lightweight Layered IO-Accelerator)：第1階層ストレージ</p>
<p>ジョブ実行時の専用ファイルシステムであり、階層化ストレージの利用のしやすさとアプリケーションファイルの入出力の高速化を目指しています。SSDで構成され、用途に応じて3種類の領域を利用できます。</p>
</li>
</ul>
<blockquote>
<div><table class="docutils align-default" id="id13">
<caption><span class="caption-text">LLIOの領域</span><a class="headerlink" href="#id13" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 18.2%" />
<col style="width: 18.2%" />
<col style="width: 63.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>領域</p></th>
<th class="head"><p>名前空間</p></th>
<th class="head"><p>用途</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LLIOの第2階層キャッシュ領域</p></td>
<td><p>第2階層ファイルシステム</p></td>
<td><p>【保存ファイル】</p>
<p>第1階層ストレージ(LLIO)と第2階層ストレージ(FEFS)の2つから構成されます。ジョブ実行中に利用できるFEFSに対するキャッシュ機能です。</p>
<ul class="simple">
<li><p>アプリケーションがファイルのREAD要求を発行した場合、LLIOがファイルデータを自動的に第2階層ストレージ(FEFS)から第1階層ストレージ(LLIO)に読み込み、キャッシングを行います。</p></li>
<li><p>アプリケーションがWRITE要求を発行した場合、第1階層ストレージにバッファリングを行い、LLIOがアプリケーション実行とは非同期に第2階層ストレージ(FEFS)へ書き出しを行います。</p></li>
<li><p>ジョブ終了後、ジョブ実行中に作成されたディレクトリやファイルは削除されません。</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>LLIOの共有テンポラリ領域</p></td>
<td><p>ジョブ内共有</p></td>
<td><p>【一時ファイル】</p>
<p>ジョブ内でファイル共有できるテンポラリ領域でありジョブ実行中に利用できます。第2階層ストレージ(FEFS)とは独立しています。</p>
<ul class="simple">
<li><p>アプリケーションが実行される複数計算ノード間で読み書きしたデータを共有させる一時ファイルの保存先に適しています。第1階層ストレージ(LLIO)を用いてアプリケーションの開始時に一時的なファイルシステムが生成します。</p></li>
<li><p>ジョブ終了後、ファイルシステムは自動的に解放され、ジョブ実行中に作成されたディレクトリやファイルも削除されます。</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>LLIOのノード内テンポラリ領域</p></td>
<td><p>ノード内共有</p></td>
<td><p>【一時ファイル】</p>
<p>1ノード内に閉じたテンポラリ領域でありジョブ実行中に利用できます。第2階層ストレージ(FEFS)とは独立しています。</p>
<ul class="simple">
<li><p>第1階層ストレージ(LLIO)を用いてアプリケーションの開始時に一時的なファイルシステムを生成します。</p></li>
<li><p>ジョブ終了後、ファイルシステムは自動的に解放され、ジョブ実行中に作成されたディレクトリやファイルも削除されます。</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="id5">
<h3><span class="section-number">2.2.2. </span>階層化ストレージとは<a class="headerlink" href="#id5" title="この見出しへのパーマリンク">¶</a></h3>
<p>階層化ストレージは、高速アクセスが可能な【第1階層ストレージ (LLIO)】 と、大量のデータを長期保管可能な【第2階層ストレージ (FEFS)】 を組み合わせたファイルシステムです。
複数の計算ノードからIOを処理することにより、ファイルへの高速アクセスが期待できます</p>
<p>参考：<a class="reference external" href="https://www.fugaku.r-ccs.riken.jp/doc_root/ja/user_guides/perf/Perf-FS.pdf">性能情報</a></p>
<ul class="simple">
<li><p>アクセス方法</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>ジョブ (計算ノード) からのアクセス</p>
<ul>
<li><p>第1階層ストレージを経由して第2階層ストレージにアクセスします。</p></li>
<li><p>第2階層ストレージに直接アクセスします。</p></li>
</ul>
</li>
<li><p>ログインノードからのアクセス</p>
<ul>
<li><p>第2階層ストレージに直接アクセスします。</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>留意事項</p>
<ul>
<li><p><a class="reference external" href="https://www.fugaku.r-ccs.riken.jp/doc_root/ja/user_guides/use_latest/LayeredStorageAndLLIO/LLIOconsiderpoints.html">利用手引書-利用およびジョブ実行編-</a>をご参照ください。</p></li>
</ul>
</li>
</ul>
</section>
<section id="id7">
<h3><span class="section-number">2.2.3. </span>階層化ストレージの使用判断フロー<a class="headerlink" href="#id7" title="この見出しへのパーマリンク">¶</a></h3>
<p>FEFS/LLIOの利用可否は、以下のフローを用いて確認できます。</p>
<figure class="align-default">
<img alt="../_images/LayerdStorageDecisionFlow_01.png" src="../_images/LayerdStorageDecisionFlow_01.png" />
</figure>
<p>利用する容量によってLLIO領域が利用できない場合があります。その場合はFEFS領域(/2ndfs)を利用してください。
詳細は <a class="reference internal" href="../CapacitySetting/index.html#firstlayercapacitysetting"><span class="std std-ref">第1階層ストレージの容量設定</span></a> を参照ください。</p>
</section>
</section>
<section id="id8">
<h2><span class="section-number">2.3. </span>第1階層ストレージ<a class="headerlink" href="#id8" title="この見出しへのパーマリンク">¶</a></h2>
<p>第1階層ストレージは、図示の通り3種類の領域を提供しています。</p>
<figure class="align-default">
<img alt="../_images/AboutLLIO_01.png" src="../_images/AboutLLIO_01.png" />
</figure>
<div class="line-block">
<div class="line"><a class="reference internal" href="#nodetemporaryarea"><span class="std std-ref">ノード内テンポラリ領域</span></a>／ <a class="reference internal" href="#sharedtemporaryarea"><span class="std std-ref">共有テンポラリ領域</span></a>／ <a class="reference internal" href="#cacheofsecondlayerstoragearea"><span class="std std-ref">第2階層ストレージキャッシュ領域</span></a>があります。</div>
<div class="line">3種類の領域の切り替えは、ファイルのオープン時のパス名を用いて行います。</div>
</div>
<section id="nodetemporaryarea">
<span id="id9"></span><h3><span class="section-number">2.3.1. </span>ノード内テンポラリ領域とは<a class="headerlink" href="#nodetemporaryarea" title="この見出しへのパーマリンク">¶</a></h3>
<p>計算ノード内に閉じたテンポラリ領域であり、一時ファイルへの高速アクセスが期待できます。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>利点</p></th>
<th class="head"><p>考慮点</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ul class="simple">
<li><p>メタ処理が計算ノードごとに分散されるため、メタアクセスの高速化が期待できます。</p></li>
<li><p>第2階層ストレージへの書き出しが不要となるため、ファイルアクセスの高速化が期待できます。</p></li>
<li><p>一時ファイルは、ユーザが意識することなく自動的に削除します。</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>ファイルを共有する範囲はノード内に限定されます。</p></li>
<li><p>ファイルシステムの容量に上限があります。</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>利用方法</p>
<blockquote>
<div><ul class="simple">
<li><p>ジョブパラメータ&quot;localtmp-size&quot;をジョブスクリプトに指定します。</p></li>
<li><p>アクセスパスは環境変数&quot;PJM_LOCALTMP&quot;に設定されます。</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>活用例(1): ノード内に閉じたファイルアクセスの性能改善</p>
<p>環境変数TMPDIRにノード内テンポラリ領域を指定後、このDIRに対して読み書きするファイルに対して、ファイルへの高速アクセスが期待できます。
環境変数TMPDIRに中間ファイルを作成するprog1のスクリプト例を以下に示します。</p>
<ul class="simple">
<li><p>ノード内テンポラリ領域を使用しないジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash -x
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4&quot;
#PJM -s

export TMPDIR=${TMPDIR}/temp
mkdir -p ${TMPDIR}
mpiexec ./prog1
rm –rf ${TMPDIR}/* #中間ファイルを削除する
</pre></div>
</div>
<ul class="simple">
<li><p>ノード内テンポラリ領域を活用したジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash -x
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4&quot;
#PJM --llio localtmp-size=30Gi # ノード内テンポラリ領域の容量を指定
#PJM --llio perf # LLIO性能情報の出力:ノード数に応じて出力量が増えるので注意
#PJM -s

export TMPDIR=${PJM_LOCALTMP}
mpiexec ./prog1

#ジョブ完了後にファイルシステムが消滅するため、中間ファイルの削除不要
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/NodeTemporary1_01.png" src="../_images/NodeTemporary1_01.png" />
</figure>
</li>
<li><p>活用例(2): ファイルの事前展開によるファイルアクセスの高速化</p>
<p>実行ファイルや複数の入力ファイルが存在する場合、それらのファイル群をアーカイブします。アーカイブファイルをノード内テンポラリ領域に転送してジョブ実行前に展開します。
このことにより、ジョブ実行時には、これらのファイルへの高速アクセスが期待できます。</p>
<p>アーカイブファイルをノード内テンポラリ領域に展開する例を以下に示します。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash -x
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4&quot;
#PJM --llio localtmp-size=30Gi # ノード内テンポラリ領域の容量を指定
#PJM --llio perf # LLIO性能情報の出力:ノード数に応じて出力量が増えるので注意
#PJM -s

# archive.tarを第2階層ストレージのキャッシュへコピー
llio_transfer ./archive.tar

# ノード内の1プロセスからarchive.tarを展開
mpiexec sh -c &#39;if [ ${PLE_RANK_ON_NODE} -eq 0 ]; then ¥
                  tar xf ./archive.tar -C $PJM_LOCALTMP; ¥
               fi

# archive.tarを第2階層ストレージのキャッシュから削除
llio_transfer --purge ./archive.tar

# archive.tar内のbin/prog1を実行
mpiexec $PJM_LOCALTMP/bin/prog1
</pre></div>
</div>
</li>
</ul>
</section>
<section id="sharedtemporaryarea">
<span id="id10"></span><h3><span class="section-number">2.3.2. </span>共有テンポラリ領域とは<a class="headerlink" href="#sharedtemporaryarea" title="この見出しへのパーマリンク">¶</a></h3>
<p>ジョブ内に閉じたテンポラリ領域であり、一時ファイルへの高速アクセスが期待できます。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>利点</p></th>
<th class="head"><p>考慮点</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ul class="simple">
<li><p>第2階層ストレージへの書き出しが不要となるため、ファイルアクセスの高速化が期待できます。</p></li>
<li><p>一時ファイルは、ユーザが意識することなく自動的に削除します。</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>ファイルを共有する範囲はジョブ内に限定されます。</p></li>
<li><p>ファイルシステムの容量に上限があります。</p></li>
<li><p>複数のプロセスから同一のファイルに書き込みを行う場合、ロック処理が必要となります。プログラムでロック処理を行う場合は、<a class="reference external" href="https://www.fugaku.r-ccs.riken.jp/doc_root/ja/user_guides/use_latest/LayeredStorageAndLLIO/WriteForFilesystem.html">利用手引書-利用およびジョブ実行編-</a>をご参照ください。ロック処理はMPI-IO を利活用することにより代用することも可能です。</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>利用方法</p>
<blockquote>
<div><ul class="simple">
<li><p>ジョブパラメータ&quot;sharedtmp-size&quot;をジョブスクリプトに指定します。</p></li>
<li><p>アクセスパスは環境変数&quot;PJM_SHAREDTMP&quot;に設定されます。</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>活用例：ジョブ内にとじた途中経過などへのファイルアクセスの高速化</p>
<p>計算の途中経過を共有テンポラリ領域に出力することにより、プログラムからファイルへの高速アクセスが期待できます。
ジョブprog1の結果をジョブprog2が読み込み最終的な計算結果を出力するスクリプト例を以下に示します。</p>
<ul class="simple">
<li><p>共有テンポラリ領域を使用しないジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4&quot;
#PJM -s

### 1. プログラムprog1がFEFS領域に計算結果out.dataを出力
mpiexec ./prog1 -o ./out.data

### 2. プログラムprog2がout.dataを読み込んで
### 最終的な結果result.dataを出力
mpiexec ./prog2 –i ./out.data -o ./result.data
</pre></div>
</div>
<ul class="simple">
<li><p>共有テンポラリ領域を活用したジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4&quot;
#PJM --llio sharedtmp-size=10Gi # 共有テンポラリ領域の容量を指定
#PJM -s

### 1. プログラムprog1が共有テンポラリ領域に計算結果out.dataを出力
mpiexec ./prog1 -o ${PJM_SHAREDTMP}/out.data

### 2. プログラムprog2がout.dataを読み込んで
### 最終的な結果result.dataを出力
mpiexec ./prog2 –i ${PJM_SHAREDTMP}/out.data -o ${PJM_SHAREDTMP}/result.data

#### 3. ジョブ終了前にresult.dataをジョブ実行ディレクトリに退避
cp –p ${PJM_SHAREDTMP}/result.data ${PJM_JOBDIR}/result.data
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/SharedTemporary_01.png" src="../_images/SharedTemporary_01.png" />
</figure>
</li>
</ul>
</section>
<section id="cacheofsecondlayerstoragearea">
<span id="id11"></span><h3><span class="section-number">2.3.3. </span>第2階層ストレージキャッシュ領域とは<a class="headerlink" href="#cacheofsecondlayerstoragearea" title="この見出しへのパーマリンク">¶</a></h3>
<p>第2階層ストレージにアクセスしたデータをキャッシュすることにより、ファイルへの高速アクセスが期待できます。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>利点</p></th>
<th class="head"><p>考慮点</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ul class="simple">
<li><p>同一ファイルに複数回アクセスする場合、キャッシュされたデータが利用されるため、ファイルへの高速アクセスが期待できます。</p></li>
<li><p>第2階層ストレージと同じパスでアクセスできるため、スクリプト変更は不要です。</p></li>
<li><p>書込みデータは、ジョブ実行とは非同期に第2階層ストレージへ書き出しが行われます。</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>複数のプロセスから各々のファイルに同時書き込みを行う場合、キャッシュの同期処理に時間を要します。</p></li>
<li><p>複数のプロセスから同一のファイルに書き込みを行う場合、ロック処理が必要となります。プログラムでロック処理を行う場合は、<a class="reference external" href="https://www.fugaku.r-ccs.riken.jp/doc_root/ja/user_guides/use_latest/LayeredStorageAndLLIO/WriteForFilesystem.html">利用手引書-利用およびジョブ実行編-</a>をご参照ください。ロック処理はMPI-IO を利活用することにより代用することも可能です。</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<ul>
<li><p>利用方法</p>
<ul class="simple">
<li><p>アクセスパスは第2階層ストレージと同じパスです。</p></li>
</ul>
</li>
<li><p>活用例：ジョブ実行中のファイルアクセスの高速化</p>
<p>同一ファイルから複数回読み込む場合、キャッシュされたデータが利用されるため、ファイルへの高速アクセスが期待できます。
prog1のスクリプト例を以下に示します。</p>
<ul class="simple">
<li><p>第2階層ストレージキャッシュを使用しないジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4“
#PJM --llio sio-read-cache=off # 第2階層ストレージキャッシュを使わない
#PJM -s

### 1. プログラムprog1がFEFS領域に計算結果out.dataを出力
mpiexec ./prog1 ./in.data -o ./out.data
</pre></div>
</div>
<ul class="simple">
<li><p>第2階層ストレージキャッシュを活用したジョブスクリプト</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#PJM -L &quot;rscunit=rscunit_ft01&quot;
#PJM -L &quot;node=48&quot;
#PJM -L &quot;rscgrp=small&quot;
#PJM -L &quot;elapse=1:00:00&quot;
#PJM -g groupname
#PJM --mpi &quot;max-proc-per-node=4“
#PJM --llio localtmp-size=0Gi # ノード内テンポラリ領域の容量を指定
#PJM --llio sharedtmp-size=0Gi # 共有テンポラリ領域の容量を指定
###第2階層ストレージキャッシュ領域の容量は以下。
###87GiB – (localtmp-sizeの設定値 + sharedtmp-sizeの設定値)
#PJM --llio sio-read-cache=on # 第2階層ストレージキャッシュの利用を指定
#PJM -s

### 1. プログラムprog1が第2階層ストレージキャッシュに計算結果out.dataを出力
mpiexec ./prog1 ./in.data -o ./out.data
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="id12">
<h2><span class="section-number">2.4. </span>第2階層ストレージ<a class="headerlink" href="#id12" title="この見出しへのパーマリンク">¶</a></h2>
<p>第2階層ストレージは大容量なファイルを保存可能な並列分散ファイルシステムです。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>利点</p></th>
<th class="head"><p>考慮点</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FEFS は、アプリケーションの作業領域および/home 配下の領域に使用できます。</p></td>
<td><p>各々の利用者には容量が制限されています。より大容量な容量が必要な場合、申請が必要です。</p></td>
</tr>
</tbody>
</table>
<ul>
<li><p>利用方法</p>
<div class="line-block">
<div class="line">ログインノードにログインし、ホーム領域やデータ領域としてアクセスできる領域が第2階層ストレージです。</div>
<div class="line">計算ノードからは上記と同じファイルパスでファイルにアクセスできますが、第1階層ストレージ経由でのアクセスとなります。</div>
<div class="line">直接計算ノードから第2階層ストレージにアクセスするためには、専用の領域である/2ndfsを利用ください。/2ndfsの利用方法の詳細は <a class="reference external" href="https://www.fugaku.r-ccs.riken.jp/doc_root/ja/user_guides/use_latest/UsageRules/index.html#diskpoints">利用手引書-利用およびジョブ実行編-</a>をご確認ください。</div>
</div>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">目次</a></h3>
    <ul>
<li><a class="reference internal" href="#">2. ストレージの概要</a><ul>
<li><a class="reference internal" href="#id2">2.1. ジョブ投入の流れ</a></li>
<li><a class="reference internal" href="#id3">2.2. 「富岳」のストレージの構成概要</a><ul>
<li><a class="reference internal" href="#id4">2.2.1. 「富岳」で利用可能なファイルシステム</a></li>
<li><a class="reference internal" href="#id5">2.2.2. 階層化ストレージとは</a></li>
<li><a class="reference internal" href="#id7">2.2.3. 階層化ストレージの使用判断フロー</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8">2.3. 第1階層ストレージ</a><ul>
<li><a class="reference internal" href="#nodetemporaryarea">2.3.1. ノード内テンポラリ領域とは</a></li>
<li><a class="reference internal" href="#sharedtemporaryarea">2.3.2. 共有テンポラリ領域とは</a></li>
<li><a class="reference internal" href="#cacheofsecondlayerstoragearea">2.3.3. 第2階層ストレージキャッシュ領域とは</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">2.4. 第2階層ストレージ</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>前のトピックへ</h4>
    <p class="topless"><a href="../Introduction/index.html"
                          title="前の章へ"><span class="section-number">1. </span>はじめに</a></p>
  </div>
  <div>
    <h4>次のトピックへ</h4>
    <p class="topless"><a href="../CapacitySetting/index.html"
                          title="次の章へ"><span class="section-number">3. </span>容量設定</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../CapacitySetting/index.html" title="3. 容量設定"
             >次へ</a></li>
        <li class="right" >
          <a href="../Introduction/index.html" title="1. はじめに"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">プログラミングガイド IO編  ドキュメント</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span>ストレージの概要</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, 理化学研究所計算科学研究センター.
    &nbsp;&nbsp;<a href="https://www.fugaku.r-ccs.riken.jp/">Fugaku website Top</a>
    </div>
  </body>
</html>